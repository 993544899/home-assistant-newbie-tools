(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{158:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ExternalAuth});var home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(29);const CALLBACK_SET_TOKEN="externalAuthSetToken",CALLBACK_REVOKE_TOKEN="externalAuthRevokeToken";if(!window.externalApp&&!window.webkit){throw new Error("External auth requires either externalApp or webkit defined on Window object.")}class ExternalAuth extends home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_0__.a{constructor(hassUrl){super({hassUrl,clientId:"",refresh_token:"",access_token:"",expires_in:0,expires:0})}async refreshAccessToken(){const responseProm=new Promise((resolve,reject)=>{window[CALLBACK_SET_TOKEN]=(success,data)=>success?resolve(data):reject(data)});await 0;const callbackPayload={callback:CALLBACK_SET_TOKEN};if(window.externalApp){window.externalApp.getExternalAuth(JSON.stringify(callbackPayload))}else{window.webkit.messageHandlers.getExternalAuth.postMessage(callbackPayload)}const tokens=await responseProm;this.data.access_token=tokens.access_token;this.data.expires=1e3*tokens.expires_in+Date.now()}async revoke(){const responseProm=new Promise((resolve,reject)=>{window[CALLBACK_REVOKE_TOKEN]=(success,data)=>success?resolve(data):reject(data)});await 0;const callbackPayload={callback:CALLBACK_REVOKE_TOKEN};if(window.externalApp){window.externalApp.revokeExternalAuth(JSON.stringify(callbackPayload))}else{window.webkit.messageHandlers.revokeExternalAuth.postMessage(callbackPayload)}await responseProm}}}}]);
//# sourceMappingURL=68530301c6482c01650a.chunk.js.map