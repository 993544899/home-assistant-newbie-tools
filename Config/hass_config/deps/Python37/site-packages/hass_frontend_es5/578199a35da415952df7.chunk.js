(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{178:function(module,__webpack_exports__,__webpack_require__){"use strict";var index_es=__webpack_require__(209);function isEntityId(value){if("string"!==typeof value){return"entity id should be a string"}if(!value.includes(".")){return"entity id should be in the format 'domain.entity'"}return!0}function isIcon(value){if("string"!==typeof value){return"icon should be a string"}if(!value.includes(":")){return"icon should be in the format 'mdi:icon'"}return!0}__webpack_require__.d(__webpack_exports__,"a",function(){return struct});var struct=Object(index_es.a)({types:{"entity-id":isEntityId,icon:isIcon}})},383:function(module,__webpack_exports__,__webpack_require__){"use strict";var codemirror__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(335),codemirror__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(codemirror__WEBPACK_IMPORTED_MODULE_0__),codemirror_mode_yaml_yaml__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(447),codemirror_mode_yaml_yaml__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(codemirror_mode_yaml_yaml__WEBPACK_IMPORTED_MODULE_1__),codemirror_lib_codemirror_css__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(448),codemirror_lib_codemirror_css__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(codemirror_lib_codemirror_css__WEBPACK_IMPORTED_MODULE_2__),_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(44),_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(83);function _typeof(obj){if("function"===typeof Symbol&&"symbol"===typeof Symbol.iterator){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0,descriptor;i<props.length;i++){descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value"in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"===typeof call)){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});if(superClass)_setPrototypeOf(subClass,superClass)}function _wrapNativeSuper(Class){var _cache="function"===typeof Map?new Map:void 0;_wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!_isNativeFunction(Class))return Class;if("function"!==typeof Class){throw new TypeError("Super expression must either be null or a function")}if("undefined"!==typeof _cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(e){return!1}}function _construct(Parent,args,Class){if(isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a),instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var HuiYamlEditor=function(_HTMLElement){_inherits(HuiYamlEditor,_HTMLElement);function HuiYamlEditor(){var _this;_classCallCheck(this,HuiYamlEditor);_this=_possibleConstructorReturn(this,_getPrototypeOf(HuiYamlEditor).call(this));_this._hass=void 0;_this.codemirror=void 0;_this._value=void 0;codemirror__WEBPACK_IMPORTED_MODULE_0___default.a.commands.save=function(cm){Object(_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_3__.a)(cm.getWrapperElement(),"yaml-save")};_this._value="";var shadowRoot=_this.attachShadow({mode:"open"});shadowRoot.innerHTML="\n            <style>\n              ".concat(codemirror_lib_codemirror_css__WEBPACK_IMPORTED_MODULE_2___default.a,"\n              .CodeMirror {\n                height: var(--code-mirror-height, auto);\n                direction: var(--code-mirror-direction, ltr);\n              }\n              .CodeMirror-scroll {\n                max-height: var(--code-mirror-max-height, --code-mirror-height);\n              }\n              .CodeMirror-gutters {\n                border-right: 1px solid var(--paper-input-container-color, var(--secondary-text-color));\n                background-color: var(--paper-dialog-background-color, var(--primary-background-color));\n                transition: 0.2s ease border-right;\n              }\n              .CodeMirror-focused .CodeMirror-gutters {\n                border-right: 2px solid var(--paper-input-container-focus-color, var(--primary-color));;\n              }\n              .CodeMirror-linenumber {\n                color: var(--paper-dialog-color, var(--primary-text-color));\n              }\n              .rtl .CodeMirror-vscrollbar {\n                right: auto;\n                left: 0px;\n              }\n              .rtl-gutter {\n                width: 20px;\n              }\n            </style>");return _this}_createClass(HuiYamlEditor,[{key:"connectedCallback",value:function connectedCallback(){var _this2=this;if(!this.codemirror){this.codemirror=codemirror__WEBPACK_IMPORTED_MODULE_0___default()(this.shadowRoot,{value:this._value,lineNumbers:!0,mode:"yaml",tabSize:2,autofocus:!0,viewportMargin:Infinity,gutters:this._hass&&Object(_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_4__.a)(this._hass)?["rtl-gutter","CodeMirror-linenumbers"]:[]});this.setScrollBarDirection();this.codemirror.on("changes",function(){return _this2._onChange()})}else{this.codemirror.refresh()}}},{key:"_onChange",value:function _onChange(){Object(_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_3__.a)(this,"yaml-changed",{value:this.codemirror.getValue()})}},{key:"setScrollBarDirection",value:function setScrollBarDirection(){if(!this.codemirror){return}this.codemirror.getWrapperElement().classList.toggle("rtl",Object(_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_4__.a)(this._hass))}},{key:"hass",set:function set(hass){this._hass=hass;if(this._hass){this.setScrollBarDirection()}}},{key:"value",set:function set(value){if(this.codemirror){if(value!==this.codemirror.getValue()){this.codemirror.setValue(value)}}this._value=value},get:function get(){return this.codemirror.getValue()}},{key:"hasComments",get:function get(){return this.shadowRoot.querySelector("span.cm-comment")?!0:!1}}]);return HuiYamlEditor}(_wrapNativeSuper(HTMLElement));window.customElements.define("hui-yaml-editor",HuiYamlEditor)},750:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var lit_element__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(63),js_yaml__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(444),js_yaml__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(js_yaml__WEBPACK_IMPORTED_MODULE_2__),_polymer_app_layout_app_header_layout_app_header_layout__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(135),_polymer_app_layout_app_header_app_header__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(134),_polymer_app_layout_app_toolbar_app_toolbar__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(111),_material_mwc_button__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(73),_polymer_paper_icon_button_paper_icon_button__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(96),_polymer_paper_spinner_paper_spinner__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(171),_common_structs_struct__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(178),_components_ha_icon__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(164),_resources_styles__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(56),_components_hui_yaml_editor__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(383);function _typeof(obj){if("function"===typeof Symbol&&"symbol"===typeof Symbol.iterator){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _templateObject2(){var data=_taggedTemplateLiteral(["\n        :host {\n          --code-mirror-height: 100%;\n        }\n\n        app-header-layout {\n          height: 100vh;\n        }\n\n        app-toolbar {\n          background-color: var(--dark-background-color, #455a64);\n          color: var(--dark-text-color);\n        }\n\n        .comments {\n          font-size: 16px;\n        }\n\n        .content {\n          height: calc(100vh - 68px);\n        }\n\n        hui-code-editor {\n          height: 100%;\n        }\n\n        .save-button {\n          opacity: 0;\n          font-size: 14px;\n          padding: 0px 10px;\n        }\n\n        .saved {\n          opacity: 1;\n        }\n      "]);_templateObject2=function _templateObject2(){return data};return data}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}}function _templateObject(){var data=_taggedTemplateLiteral(["\n      <app-header-layout>\n        <app-header>\n          <app-toolbar>\n            <paper-icon-button\n              icon=\"hass:close\"\n              @click=\"","\"\n            ></paper-icon-button>\n            <div main-title>\n              ","\n            </div>\n            <div\n              class=\"save-button\n              ","\"\n            >\n              ","\n            </div>\n            <mwc-button raised @click=\"","\"\n              >","</mwc-button\n            >\n          </app-toolbar>\n        </app-header>\n        <div class=\"content\">\n          <hui-yaml-editor\n            .hass=\"","\"\n            @yaml-changed=\"","\"\n            @yaml-save=\"","\"\n          >\n          </hui-yaml-editor>\n        </div>\n      </app-header-layout>\n    "]);_templateObject=function _templateObject(){return data};return data}function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0)}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0,descriptor;i<props.length;i++){descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value"in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"===typeof call)){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var lovelaceStruct=_common_structs_struct__WEBPACK_IMPORTED_MODULE_9__.a.interface({title:"string?",views:["object"],resources:_common_structs_struct__WEBPACK_IMPORTED_MODULE_9__.a.optional(["object"])}),LovelaceFullConfigEditor=function(_LitElement){_inherits(LovelaceFullConfigEditor,_LitElement);function LovelaceFullConfigEditor(){var _getPrototypeOf2,_this;_classCallCheck(this,LovelaceFullConfigEditor);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(LovelaceFullConfigEditor)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.hass=void 0;_this.lovelace=void 0;_this.closeEditor=void 0;_this._saving=void 0;_this._changed=void 0;_this._generation=void 0;return _this}_createClass(LovelaceFullConfigEditor,[{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_0__.e)(_templateObject(),this._closeEditor,this.hass.localize("ui.panel.lovelace.editor.raw_editor.header"),Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__.a)({saved:!1===this._saving||!0===this._changed}),this._changed?this.hass.localize("ui.panel.lovelace.editor.raw_editor.unsaved_changes"):this.hass.localize("ui.panel.lovelace.editor.raw_editor.saved"),this._handleSave,this.hass.localize("ui.panel.lovelace.editor.raw_editor.save"),this.hass,this._yamlChanged,this._handleSave)}},{key:"firstUpdated",value:function firstUpdated(){this.yamlEditor.value=js_yaml__WEBPACK_IMPORTED_MODULE_2___default.a.safeDump(this.lovelace.config);this.yamlEditor.codemirror.clearHistory();this._generation=this.yamlEditor.codemirror.changeGeneration(!0)}},{key:"_yamlChanged",value:function _yamlChanged(){if(!this._generation){return}this._changed=!this.yamlEditor.codemirror.isClean(this._generation);if(this._changed&&!window.onbeforeunload){window.onbeforeunload=function(){return!0}}else if(!this._changed&&window.onbeforeunload){window.onbeforeunload=null}}},{key:"_closeEditor",value:function _closeEditor(){if(this._changed){if(!confirm("You have unsaved changes, are you sure you want to exit?")){return}}window.onbeforeunload=null;if(this.closeEditor){this.closeEditor()}}},{key:"_handleSave",value:function(){var _handleSave2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var value;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this._saving=!0;if(!this.yamlEditor.hasComments){_context.next=4;break}if(confirm("Your config contains comment(s), these will not be saved. Do you want to continue?")){_context.next=4;break}return _context.abrupt("return");case 4:_context.prev=4;value=js_yaml__WEBPACK_IMPORTED_MODULE_2___default.a.safeLoad(this.yamlEditor.value);_context.next=13;break;case 8:_context.prev=8;_context.t0=_context["catch"](4);alert("Unable to parse YAML: ".concat(_context.t0));this._saving=!1;return _context.abrupt("return");case 13:_context.prev=13;value=lovelaceStruct(value);_context.next=21;break;case 17:_context.prev=17;_context.t1=_context["catch"](13);alert("Your config is not valid: ".concat(_context.t1));return _context.abrupt("return");case 21:_context.prev=21;_context.next=24;return this.lovelace.saveConfig(value);case 24:_context.next=29;break;case 26:_context.prev=26;_context.t2=_context["catch"](21);alert("Unable to save YAML: ".concat(_context.t2));case 29:this._generation=this.yamlEditor.codemirror.changeGeneration(!0);window.onbeforeunload=null;this._saving=!1;this._changed=!1;case 33:case"end":return _context.stop();}}},_callee,this,[[4,8],[13,17],[21,26]])}));function _handleSave(){return _handleSave2.apply(this,arguments)}return _handleSave}()},{key:"yamlEditor",get:function get(){return this.shadowRoot.querySelector("hui-yaml-editor")}}],[{key:"properties",get:function get(){return{hass:{},lovelace:{},closeEditor:{},_saving:{},_changed:{}}}},{key:"styles",get:function get(){return[_resources_styles__WEBPACK_IMPORTED_MODULE_11__.a,Object(lit_element__WEBPACK_IMPORTED_MODULE_0__.c)(_templateObject2())]}}]);return LovelaceFullConfigEditor}(lit_element__WEBPACK_IMPORTED_MODULE_0__.a);customElements.define("hui-editor",LovelaceFullConfigEditor)}}]);
//# sourceMappingURL=578199a35da415952df7.chunk.js.map